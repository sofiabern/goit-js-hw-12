{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nasync function getDataFromAPI(search, page, perPage) {\n  const API_KEY = '39362116-97c7d5619fee8bb7db7b12f12';\n  const imageType = 'photo';\n  const photoOrientation = 'horizontal';\n  const safeSearch = true;\n  const per_page = 15;\n\n  const params = {\n    key: API_KEY,\n    q: search,\n    image_type: imageType,\n    orientation: photoOrientation,\n    safesearch: safeSearch,\n    page,\n    per_page,\n  };\n\n  try {\n    const response = await axios.get('https://pixabay.com/api/', { params });\n    return response.data;\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nexport { getDataFromAPI };\n","function createMarkup(array){\n    return array.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n    <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img class=\"gallery-image\"  src=\"${webformatURL}\" alt=\"${tags}\">\n      <ul class=\"descr-list\">\n        <li class=\"descr-item\"><span class=\"descr-header\">Likes</span> <span class=\"descr-value\">${likes}</span></li>\n        <li class=\"descr-item\"><span class=\"descr-header\">Views</span> <span class=\"descr-value\">${views}</span></li>\n        <li class=\"descr-item\"><span class=\"descr-header\">Comments</span> <span class=\"descr-value\">${comments}</span></li>\n        <li class=\"descr-item\"><span class=\"descr-header\">Downloads</span> <span class=\"descr-value\">${downloads}</span></li>\n      </ul>\n      </a>\n    </li>`).join(\" \")\n    }\n    \n    export {createMarkup}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getDataFromAPI } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\n// DOM elements\nconst formEl = document.querySelector('.search-form');\nconst inputEl = formEl.elements.search;\nconst gallery = document.querySelector('.gallery');\nlet galleryCard;\nconst loaderEl = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.js-loadbtn');\n\n\nconst simplelightbox = new SimpleLightbox('.gallery-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  showCounter: false,\n});\n\nfunction loaderToggle() {\n  loaderEl.classList.toggle('hidden');\n}\n\nfunction updateLoadBtnVisibility() {\n  if (renderedHits < totalHits) {\n    loadBtn.classList.remove('hidden');\n  } else {\n    loadBtn.classList.add('hidden');\n    showError(\"We're sorry, but you've reached the end of search results.\");\n  }\n}\n\nfunction resetForPagination() {\n  currentPage = 1;\n  renderedHits = 15;\n}\n\nfunction cleanGallery() {\n  if (gallery.innerHTML) gallery.innerHTML = '';\n}\n\nfunction smoothScroll(){\n  const cardHeight = galleryCard.getBoundingClientRect().height;\n  window.scrollBy({\n    top: 3 * cardHeight, \n    behavior: 'smooth' \n  });\n}\n\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: `${message}`,\n  });\n}\n\nlet currentPage = 1;\nlet renderedHits = 15;\nlet currentQuery;\nlet totalHits;\n\nasync function getPhotoFromAPI(query, page) {\n  try {\n    const data = await getDataFromAPI(query, page);\n\n    totalHits = data.totalHits;\n\n    if (!data.hits.length) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    simplelightbox.refresh();\n    updateLoadBtnVisibility();\n    \n  } catch (error) {\n    showError('Sorry, something wrong happened while fetching.');\n    console.error(error);\n  } finally {\n    loaderToggle();\n  }\n}\n\nformEl.addEventListener('submit', searchHandler);\nfunction searchHandler(evt) {\n  evt.preventDefault();\n\n  cleanGallery();\n  loaderToggle();\n\n  if (!inputEl.value.trim()) {\n    loaderToggle();\n    showError('Please enter something!');\n    return;\n  }\n\n  currentQuery = inputEl.value;\n\n  getPhotoFromAPI(currentQuery, currentPage);\n  \n}\n\nloadBtn.addEventListener('click', loadMoreHandler);\n\nfunction loadMoreHandler() {\n  if (renderedHits >= totalHits) {\n    resetForPagination();\n    return;\n  }\n  currentPage += 1;\n  renderedHits += 15;\n\n  loaderToggle();\n  \n  galleryCard = document.querySelector('.gallery-item');\n  getPhotoFromAPI(currentQuery, currentPage).then(()=>{\n   \n    smoothScroll()\n  })\n\n}\n"],"names":["getDataFromAPI","search","page","perPage","params","axios","error","createMarkup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","formEl","inputEl","gallery","galleryCard","loaderEl","loadBtn","simplelightbox","SimpleLightbox","loaderToggle","updateLoadBtnVisibility","renderedHits","totalHits","showError","resetForPagination","currentPage","cleanGallery","smoothScroll","cardHeight","message","iziToast","currentQuery","getPhotoFromAPI","query","data","searchHandler","evt","loadMoreHandler"],"mappings":"owBAEA,eAAeA,EAAeC,EAAQC,EAAMC,EAAS,CAOnD,MAAMC,EAAS,CACb,IAPc,qCAQd,EAAGH,EACH,WARgB,QAShB,YARuB,aASvB,WAAY,GACZ,KAAAC,EACA,WACJ,EAEE,GAAI,CAEF,OADiB,MAAMG,EAAM,IAAI,2BAA4B,CAAE,OAAAD,CAAM,CAAE,GACvD,IACjB,OAAQE,EAAO,CACd,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CACH,CCzBA,SAASC,EAAaC,EAAM,CACxB,OAAOA,EAAM,IAAI,CAAC,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAM;AAAA;AAAA,oCAE7DL,CAAa;AAAA,yCACRD,CAAY,UAAUE,CAAI;AAAA;AAAA,mGAEgCC,CAAK;AAAA,mGACLC,CAAK;AAAA,sGACFC,CAAQ;AAAA,uGACPC,CAAS;AAAA;AAAA;AAAA,UAGtG,EAAE,KAAK,GAAG,CACpB,CCHA,MAAMC,EAAS,SAAS,cAAc,cAAc,EAC9CC,EAAUD,EAAO,SAAS,OAC1BE,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIC,EACJ,MAAMC,EAAW,SAAS,cAAc,SAAS,EAC3CC,EAAU,SAAS,cAAc,aAAa,EAG9CC,EAAiB,IAAIC,EAAe,kBAAmB,CAC3D,aAAc,MACd,aAAc,IACd,YAAa,EACf,CAAC,EAED,SAASC,GAAe,CACtBJ,EAAS,UAAU,OAAO,QAAQ,CACpC,CAEA,SAASK,GAA0B,CAC7BC,EAAeC,EACjBN,EAAQ,UAAU,OAAO,QAAQ,GAEjCA,EAAQ,UAAU,IAAI,QAAQ,EAC9BO,EAAU,4DAA4D,EAE1E,CAEA,SAASC,GAAqB,CAC5BC,EAAc,EACdJ,EAAe,EACjB,CAEA,SAASK,GAAe,CAClBb,EAAQ,YAAWA,EAAQ,UAAY,GAC7C,CAEA,SAASc,GAAc,CACrB,MAAMC,EAAad,EAAY,sBAAqB,EAAG,OACvD,OAAO,SAAS,CACd,IAAK,EAAIc,EACT,SAAU,QACd,CAAG,CACH,CAEA,SAASL,EAAUM,EAAS,CAC1BC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,GAAGD,CAAO,EACvB,CAAG,CACH,CAEA,IAAIJ,EAAc,EACdJ,EAAe,GACfU,EACAT,EAEJ,eAAeU,EAAgBC,EAAOpC,EAAM,CAC1C,GAAI,CACF,MAAMqC,EAAO,MAAMvC,EAAesC,EAAOpC,CAAI,EAI7C,GAFAyB,EAAYY,EAAK,UAEb,CAACA,EAAK,KAAK,OAAQ,CACrBX,EACE,0EACR,EACM,MACD,CACDV,EAAQ,mBAAmB,YAAaX,EAAagC,EAAK,IAAI,CAAC,EAC/DjB,EAAe,QAAO,EACtBG,GAED,OAAQnB,EAAO,CACdsB,EAAU,iDAAiD,EAC3D,QAAQ,MAAMtB,CAAK,CACvB,QAAY,CACRkB,GACD,CACH,CAEAR,EAAO,iBAAiB,SAAUwB,CAAa,EAC/C,SAASA,EAAcC,EAAK,CAM1B,GALAA,EAAI,eAAc,EAElBV,IACAP,IAEI,CAACP,EAAQ,MAAM,OAAQ,CACzBO,IACAI,EAAU,yBAAyB,EACnC,MACD,CAEDQ,EAAenB,EAAQ,MAEvBoB,EAAgBD,EAAcN,CAAW,CAE3C,CAEAT,EAAQ,iBAAiB,QAASqB,CAAe,EAEjD,SAASA,GAAkB,CACzB,GAAIhB,GAAgBC,EAAW,CAC7BE,IACA,MACD,CACDC,GAAe,EACfJ,GAAgB,GAEhBF,IAEAL,EAAc,SAAS,cAAc,eAAe,EACpDkB,EAAgBD,EAAcN,CAAW,EAAE,KAAK,IAAI,CAElDE,EAAc,CAClB,CAAG,CAEH"}